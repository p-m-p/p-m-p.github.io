<!doctype html>
<html lang="en-GB">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Practical web component reactivity patterns</title>
  <meta name="description" content="The web platform provides us with all the tools we need to apply reactivity to our web components. Let&#39;s explore some reactive programming patterns we can use in everyday scenarios to build interactive web pages and applications.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://philparsons.co.uk/blog/practical-web-component-reactivity-patterns/">
  <meta property="og:title" content="Practical web component reactivity patterns">
  <meta property="og:description" content="The web platform provides us with all the tools we need to apply reactivity to our web components. Let&#39;s explore some reactive programming patterns we can use in everyday scenarios to build interactive web pages and applications.">
  <meta property="og:image" content="https://philparsons.co.uk/img/socialcard/practical-web-component-reactivity-patterns.jpg">

  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://philparsons.co.uk/blog/practical-web-component-reactivity-patterns/">
  <meta property="twitter:title" content="Practical web component reactivity patterns">
  <meta property="twitter:description" content="The web platform provides us with all the tools we need to apply reactivity to our web components. Let&#39;s explore some reactive programming patterns we can use in everyday scenarios to build interactive web pages and applications.">
  <meta property="twitter:image" content="https://philparsons.co.uk/img/socialcard/practical-web-component-reactivity-patterns.jpg">

  <link rel="icon" href="/img/icon.png">
  <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Phil Parsons">
  <style>.ctc-image {
  @media (hover: hover) {
    &::part(button) {
      opacity: 0;
      transition: opacity 150ms;
    }

    &:hover::part(button) {
      opacity: 1;
    }
  }
}

copy-to-clipboard {
  /* Keep these raw color values here until there is a light theme for code blocks */
  --ctc-button-color: var(--color-white);
  --ctc-button-background: var(--color-neutral-700);
}

back-to-top {
  --btt-button-background: var(--color-bg-action);
  --btt-button-background-hover: var(--color-bg-action-hover);
  --btt-button-color: var(--color-text-primary);
}

figcaption {
  font-size: 0.875rem;
  text-align: center;
}

.post {
  max-width: 100%;
  overflow: clip;
}

.post-header {
  background: var(--color-bg-glass);
  backdrop-filter: var(--glass-blur);
  margin: 0 0 var(--spacing-md);
  padding: var(--spacing-md) 0 0;
}

.post-title {
  font-size: 3rem;
  font-weight: 700;
  line-height: 1.1;
}

.post-meta {
  align-items: baseline;
  display: flex;
  gap: var(--spacing-md);
  justify-content: right;
  padding: var(--spacing-md) 0 var(--spacing-xs);
}

.post-date {
  color: var(--color-text-secondary);
  font-size: 0.875rem;
}

.post-content {
  color: var(--color-text-secondary);

  blockquote {
    border-left: solid 4px var(--color-border-primary);
    font-style: italic;
    padding: var(--spacing-xs) var(--spacing-md);
    margin: 0 0 var(--spacing-md);

    p {
      margin-bottom: 0;
    }
  }

  p,
  ol,
  ul {
    margin: 0 0 var(--spacing-md);
    text-wrap: pretty;
  }

  ol,
  ul {
    padding: 0 0 0 var(--spacing-xl);
  }

  li {
    margin: 0 0 var(--spacing-xs);
  }

  p code {
    font-size: 0.875rem;
  }

  h2,
  h3,
  h4 {
    color: var(--color-text-primary);
    font-weight: 600;
    margin: var(--spacing-3xl) 0 var(--spacing-md);
    text-wrap: pretty;
  }

  h2 {
    font-size: 1.75rem;
    line-height: 1.2;
  }

  h3 {
    font-size: 1.25rem;
    line-height: 1.4;
  }

  h4 {
    font-size: 1rem;
    line-height: 1.4;
  }

  pre {
    font-size: 0.875rem;
    margin: 0 0 var(--spacing-3xl);
    overflow: auto;
    padding: var(--spacing-xs);
  }

  img {
    background: var(--color-bg-secondary);
    height: auto;
    margin: 0 auto;
    max-width: 100%;
    padding: var(--spacing-md);
  }
}

figure {
  margin: 0 0 var(--spacing-md);
  text-align: center;
}

.post-description {
  font-size: 1.125rem;
  line-height: 1.4;
  font-style: italic;
}

#share-fallback {
  background: black;
  border: none;
  border-radius: 1rem;
  left: 50%;
  min-width: 280px;
  padding: var(--spacing-3xl);
  top: 50%;
  transform: translate(-50%, -50%);

  &::backdrop {
    background: rgb(0 0 0 / 40%);
  }
}

.share-fallback-title {
  font-size: 1.25rem;
  margin: 0 0 var(--spacing-xs);
}

.share-fallback-links {
  display: flex;
  flex-flow: column;
  gap: var(--spacing-xs);
  list-style: none;
  margin: 0;
  padding: 0;

  a,
  a:visited,
  a:hover {
    color: white;
    text-decoration: none;
  }
}

.share-btn {
  align-items: center;
  background: var(--color-primary-500);
  border: none;
  border-radius: 999px;
  color: var(--color-black);
  cursor: pointer;
  display: inline-flex;
  font-weight: 600;
  font-size: 0.875rem;
  gap: var(--spacing-xs);
  line-height: 1;
  padding: var(--spacing-2xs) var(--spacing-sm);
  transition:
    background 200ms,
    color 200ms;

  @media (hover: hover) {
    &:hover {
      background: var(--color-primary-600);
    }
  }

  @media (prefers-color-scheme: light) {
    color: white;
  }
}

@media (width >= 600px) {
  .post-header {
    padding: var(--spacing-3xl) 0 0;
    margin: 0 0 var(--spacing-3xl);
  }
}

@media (width >= 1024px) {
  .post-content {
    font-size: 1.125rem;

    p {
      code {
        font-size: 1rem;
      }
    }

    pre {
      padding: var(--spacing-md);
    }

    h2 {
      font-size: 2rem;
    }
  }

  .post-title {
    font-size: 4rem;
  }

  .post-description {
    font-size: 1.5rem;
  }
}

@keyframes zoom-title {
  to {
    transform: rotate(-10deg) scale(1.5);
    opacity: 0.5;
  }
}

@supports (animation-timeline: scroll()) {
  .post-header {
    animation: zoom-title linear both;
    animation-timeline: scroll();
    animation-range: 0 500px;
  }
}
/**
 * a11y-dark theme for JavaScript, CSS, and HTML
 * Based on the okaidia theme: https://github.com/PrismJS/prism/blob/gh-pages/themes/prism-okaidia.css
 * @author ericwbailey
 */

code[class*="language-"],
pre[class*="language-"] {
  color: #f8f8f2;
  background: none;
  font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  tab-size: 4;
  hyphens: none;
}

:not(pre)>code[class*="language-"],
pre[class*="language-"] {
  background: var(--codeblock-bg);
  backdrop-filter: var(--glass-blur);
  border: 1px solid var(--color-border-glass);
  border-radius: 12px;
  box-shadow: var(--glass-shadow);
}

/* Inline code */
:not(pre)>code[class*="language-"] {
  padding: 0.1em;
  border-radius: 0.3em;
  white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #d4d0ab;
}

.token.punctuation {
  color: #fefefe;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
  color: #ffa07a;
}

.token.boolean,
.token.number {
  color: #00e0e0;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
  color: #abe338;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
  color: #00e0e0;
}

.token.atrule,
.token.attr-value,
.token.function {
  color: #ffd700;
}

.token.keyword {
  color: #00e0e0;
}

.token.regex,
.token.important {
  color: #ffd700;
}

.token.important,
.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}

@media (forced-colors: active) {
  code[class*="language-"],
  pre[class*="language-"] {
    color: CanvasText;
    background: Canvas;
  }

  :not(pre)>code[class*="language-"],
  pre[class*="language-"] {
    background: Canvas;
  }

  .token.important {
    background: Highlight;
    color: Canvas;
    font-weight: normal;
  }

  .token.atrule,
  .token.attr-value,
  .token.function,
  .token.keyword,
  .token.operator,
  .token.selector {
    font-weight: bold;
  }

  .token.attr-value,
  .token.comment,
  .token.doctype,
  .token.function,
  .token.keyword,
  .token.operator,
  .token.property,
  .token.string {
    color: Highlight;
  }

  .token.attr-value,
  .token.url {
    font-weight: normal;
  }
}
:root {
  color-scheme: dark;

  --color-neutral: lch(50% 5 80);
  --color-accent: lch(65% 55 165);

  --color-white: lch(98% 1 80);
  --color-black: lch(8% 3 80);

  --color-primary-50: lch(from var(--color-accent) 97% 15 h);
  --color-primary-100: lch(from var(--color-accent) 94% 25 h);
  --color-primary-200: lch(from var(--color-accent) 88% 35 h);
  --color-primary-300: lch(from var(--color-accent) 78% 45 h);
  --color-primary-400: lch(from var(--color-accent) 70% c h);
  --color-primary-500: lch(from var(--color-accent) l c h);
  --color-primary-600: lch(from var(--color-accent) 55% c h);
  --color-primary-700: lch(from var(--color-accent) 45% c h);
  --color-primary-800: lch(from var(--color-accent) 35% c h);
  --color-primary-900: lch(from var(--color-accent) 25% 40 h);
  --color-primary-950: lch(from var(--color-accent) 15% 25 h);

  --color-neutral-50: lch(from var(--color-neutral) 97% 2 h);
  --color-neutral-100: lch(from var(--color-neutral) 94% 3 h);
  --color-neutral-200: lch(from var(--color-neutral) 88% 4 h);
  --color-neutral-300: lch(from var(--color-neutral) 78% 5 h);
  --color-neutral-400: lch(from var(--color-neutral) 65% c h);
  --color-neutral-500: lch(from var(--color-neutral) l c h);
  --color-neutral-600: lch(from var(--color-neutral) 40% c h);
  --color-neutral-700: lch(from var(--color-neutral) 30% 6 h);
  --color-neutral-800: lch(from var(--color-neutral) 20% 6 h);
  --color-neutral-900: lch(from var(--color-neutral) 14% 5 h);
  --color-neutral-950: lch(from var(--color-neutral) 10% 4 h);

  --size-0: 0;
  --size-0-5: 0.125rem;
  --size-1: 0.25rem;
  --size-2: 0.5rem;
  --size-3: 0.75rem;
  --size-4: 1rem;
  --size-5: 1.25rem;
  --size-6: 1.5rem;
  --size-7: 1.75rem;
  --size-8: 2rem;
  --size-9: 2.25rem;
  --size-10: 2.5rem;
  --size-11: 2.75rem;
  --size-12: 3rem;

  --color-border-primary: lch(from var(--color-accent) 40% 20 h / 0.3);
  --color-border-glass: rgba(255, 255, 255, 0.1);

  --color-bg-primary: var(--color-black);
  --color-bg-secondary: lch(from var(--color-neutral) 12% 4 h);
  --color-bg-glass: rgba(255, 255, 255, 0.05);
  --glass-blur: blur(12px);
  --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  --color-bg-action: var(--color-neutral-800);
  --color-bg-action-hover: var(--color-primary-800);

  --color-link: var(--color-primary-400);
  --color-link-hover: var(--color-primary-300);
  --color-link-underline: var(--color-primary-600);
  --color-link-hover-underline: var(--color-primary-400);
  --color-link-visited: var(--color-primary-500);
  --color-link-visited-underline: var(--color-primary-700);
  --color-link-focus: var(--color-link-hover);
  --color-link-focus-underline: var(--color-link-hover);

  --color-icon: var(--color-primary-400);
  --color-icon-hover: var(--color-primary-300);

  --color-text-primary: var(--color-white);
  --color-text-secondary: var(--color-neutral-300);

  --spacing-2xs: var(--size-1);
  --spacing-xs: var(--size-2);
  --spacing-sm: var(--size-3);
  --spacing-md: var(--size-4);
  --spacing-lg: var(--size-5);
  --spacing-xl: var(--size-6);
  --spacing-2xl: var(--size-7);
  --spacing-3xl: var(--size-8);

  --codeblock-bg: var(--color-bg-glass);
}

*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
}

body {
  background:
    radial-gradient(ellipse at 70% 20%, lch(from var(--color-accent) 30% 40 h / 0.3) 0%, transparent 50%),
    radial-gradient(ellipse at 20% 80%, lch(from var(--color-neutral) 20% 10 h / 0.5) 0%, transparent 40%),
    linear-gradient(160deg, lch(12% 5 80) 0%, lch(6% 3 80) 100%);
  background-attachment: fixed;
  color: var(--color-text-primary);
  font-family: "Noto Sans", sans-serif;
  font-optical-sizing: auto;
  font-size: 16px;
  font-style: normal;
  font-variation-settings: "wdth" 100;
  font-weight: 400;
  line-height: 1.5;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

a {
  color: var(--color-link);
  font-weight: 500;
  position: relative;
  text-decoration: underline;
  text-underline-offset: 0.25rem;
  text-decoration-color: var(--color-link-underline);
  transition:
    text-decoration-color 200ms,
    color 200ms;

  &:visited {
    color: var(--color-link-visited);
    text-decoration-color: var(--color-link-visited-underline);
    font-weight: 400;
  }

  &:focus-visible {
    color: var(--color-link-focus);
    text-decoration-color: var(--color-link-focus-underline);
  }

  &:active {
    top: 0.125rem;
  }

  @media (hover: hover) {
    &:hover {
      color: var(--color-link-hover);
      text-decoration-color: var(--color-link-hover-underline);
    }
  }
}

@view-transition {
  navigation: auto;
}

/* Utility Classes */
.container {
  max-width: 1024px;
  margin: 0 auto;
  padding: 0 var(--spacing-md);
}

.glass {
  background: var(--color-bg-glass);
  backdrop-filter: var(--glass-blur);
  border: 1px solid var(--color-border-glass);
  box-shadow: var(--glass-shadow);
}

.glass-card {
  background: var(--color-bg-glass);
  backdrop-filter: var(--glass-blur);
  border: 1px solid var(--color-border-glass);
  border-radius: 16px;
  box-shadow: var(--glass-shadow);
}

.site-header {
  padding: var(--spacing-md) 0;

  .container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
  }
}

.site-header-link {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  text-decoration: none;
  color: var(--color-text-primary);

  &:visited {
    color: var(--color-text-primary);
  }

  &:hover {
    color: var(--color-primary-400);
  }
}

.site-header-headshot {
  display: block;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--color-primary-500);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.site-header-name {
  font-size: 1.25rem;
  font-weight: 700;
  display: none;

  @media (min-width: 480px) {
    display: block;
  }
}

.site-header-nav {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);

  @media (min-width: 480px) {
    gap: var(--spacing-md);
  }

  > a {
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color 0.2s;

    &:visited {
      color: var(--color-text-secondary);
    }

    &:hover {
      color: var(--color-primary-400);
    }
  }
}

.site-header-social {
  display: flex;
  gap: var(--spacing-xs);
  list-style: none;
  padding: 0;
  margin: 0;

  a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--color-bg-glass);
    backdrop-filter: var(--glass-blur);
    border: 1px solid var(--color-border-glass);
    color: var(--color-icon);
    transition: transform 0.2s, background 0.2s, color 0.2s;

    &:hover {
      transform: translateY(-2px);
      background: var(--color-primary-500);
      color: white;
    }
  }

  svg {
    display: block;
  }
}

.site-footer {
  padding: var(--spacing-2xl) 0;
  text-align: center;
  color: var(--color-text-secondary);
  font-size: 0.875rem;
  border-top: 1px solid var(--color-border-glass);

  .container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-xs);
  }

  span[aria-hidden] {
    display: none;
  }

  p {
    margin: 0;
  }

  a {
    font-weight: 400;
  }

  @media (min-width: 600px) {
    .container {
      flex-direction: row;
      gap: var(--spacing-md);
    }

    span[aria-hidden] {
      display: inline;
    }
  }
}

/* Light Theme */
@media (prefers-color-scheme: light) {
  :root {
    color-scheme: light;

    --color-accent: lch(50% 45 185);

    --color-primary-50: lch(from var(--color-accent) 97% 15 h);
    --color-primary-100: lch(from var(--color-accent) 94% 25 h);
    --color-primary-200: lch(from var(--color-accent) 88% 35 h);
    --color-primary-300: lch(from var(--color-accent) 78% 45 h);
    --color-primary-400: lch(from var(--color-accent) 45% c h);
    --color-primary-500: lch(from var(--color-accent) l c h);
    --color-primary-600: lch(from var(--color-accent) 40% c h);
    --color-primary-700: lch(from var(--color-accent) 35% c h);
    --color-primary-800: lch(from var(--color-accent) 28% c h);
    --color-primary-900: lch(from var(--color-accent) 22% 40 h);
    --color-primary-950: lch(from var(--color-accent) 15% 25 h);

    --color-border-primary: lch(from var(--color-accent) 50% 20 h / 0.3);
    --color-border-glass: rgba(0, 0, 0, 0.08);

    --color-bg-primary: lch(98% 1 80);
    --color-bg-secondary: lch(95% 2 80);
    --color-bg-glass: rgba(255, 255, 255, 0.6);
    --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
    --color-bg-action: var(--color-neutral-200);
    --color-bg-action-hover: var(--color-primary-200);

    --color-link: var(--color-primary-600);
    --color-link-hover: var(--color-primary-700);
    --color-link-underline: var(--color-primary-400);
    --color-link-hover-underline: var(--color-primary-500);
    --color-link-visited: var(--color-primary-700);
    --color-link-visited-underline: var(--color-primary-400);
    --color-link-focus: var(--color-link-hover);
    --color-link-focus-underline: var(--color-link-hover);

    --color-icon: var(--color-primary-600);
    --color-icon-hover: var(--color-primary-700);

    --color-text-primary: var(--color-black);
    --color-text-secondary: var(--color-neutral-600);

    --codeblock-bg: lch(14% 5 80);
  }

  body {
    background:
      radial-gradient(ellipse at 70% 20%, lch(90% 25 185 / 0.4) 0%, transparent 50%),
      radial-gradient(ellipse at 20% 80%, lch(92% 20 185 / 0.35) 0%, transparent 40%),
      linear-gradient(160deg, lch(99% 1 185) 0%, lch(97% 2 185) 100%);
  }
}</style>
  <script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "86e36e0634bb461e84a1b6a61f287b46"}'></script>

  <title>Practical web component reactivity patterns</title>
</head>

<body>
  
<header class="site-header">
  <div class="container">
    <a href="/" class="site-header-link">
      <picture><source type="image/webp" srcset="/img/vI_4A5wr5c-36.webp 36w"><img loading="lazy" decoding="async" src="/img/vI_4A5wr5c-36.jpeg" alt="" class="site-header-headshot" width="36" height="36"></picture>
      <span class="site-header-name">Phil Parsons</span>
    </a>
    <nav class="site-header-nav">
      <a href="/blog/">Blog</a>
      <ul class="site-header-social">
        <li><a href="https://github.com/p-m-p" aria-label="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg>
        </a></li>
        <li><a href="https://linkedin.com/in/phil-parsons-webdev" aria-label="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg>
        </a></li>
        <li><a href="/feed/feed.xml" aria-label="RSS Feed">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg>
        </a></li>
      </ul>
    </nav>
  </div>
</header>


<article class="post">
  <header class="post-header">
    <div class="container">
      <h1 class="post-title" style="view-transition-name: practical-web-component-reactivity-patterns">Practical web component reactivity patterns</h1>

      <div class="post-meta">
        <div class="post-date"><time datetime="2024-11-24">24 November 2024</time></div>

        <share-button>
          <button class="share-btn" slot="button" popovertarget="share-fallback">
            Share
            <span class="share-btn-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 17 20 12 15 7"></polyline><path d="M4 18v-2a4 4 0 0 1 4-4h12"></path></svg>
            </span>
          </button>

          <div popover="" id="share-fallback">
            <h2 class="share-fallback-title">Share this post</h2>
            <ul class="share-fallback-links">
              <li>
                <a href="https://bsky.app/intent/compose?text=Practical%20web%20component%20reactivity%20patterns%20https://philparsons.co.uk//blog/practical-web-component-reactivity-patterns/">ü¶ã Share on Bluesky</a>
              </li>
              <li>
                <a href="https://www.linkedin.com/shareArticle?url=https://philparsons.co.uk//blog/practical-web-component-reactivity-patterns/&title=Practical%20web%20component%20reactivity%20patterns">üè¢ Share on LinkedIn</a>
              </li>
              <li>
                <a href="https://x.com/intent/post?url=https://philparsons.co.uk//blog/practical-web-component-reactivity-patterns/&text=Practical%20web%20component%20reactivity%20patterns&via=phil_parsons">
                  üí© Share on X
                </a>
              </li>
            </ul>
          </div>
        </share-button>
      </div>
    </div>
  </header>

  <main class="post-content container">
    <p class="post-description">The web platform provides us with all the tools we need to apply reactivity to our web components. Let&#39;s explore some reactive programming patterns we can use in everyday scenarios to build interactive web pages and applications.</p>
    <h2>Keeping HTML element attributes and properties in sync</h2>
<p>If you've worked with HTML elements previously you'll likely be aware that
attributes declared on an element have no default mechanism to reflect their
value to properties on the underlying object in JavaScript. While this <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes#content_versus_idl_attributes">isn't
true for all elements and attributes</a> it makes sense
because object properties can represent any type of data and attributes are
always represented as strings. Let's look at how we can keep attribute and
property values in sync for situations that warrant it.</p>
<h3>The HTMLElement dataset</h3>
<p>The element <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset"><code>dataset</code></a> allows attributes to be set either from HTML in
the <code>data-*</code> format or via the object property in JavaScript. Take the
<code>activePage</code> property of the <code>PageFlip</code> element that we'll cover later in the
article as an example. We could use the elements <code>dataset</code> to store it and
provide an initial value in the HTML declaration.</p>
<copy-to-clipboard><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-page-flip</span> <span class="token attr-name">data-active-page</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-page-flip</span><span class="token punctuation">></span></span></code></pre></copy-to-clipboard>
<p>If we set the value of the active page from JavaScript then it is reflected to
the attribute in the HTML. You'll notice that the conversion between camel
casing and hyphens is handled for us but because the <code>dataset</code> is represented as
a <code>DomStringMap</code> it doesn't provide us any control over how the values are
stored and exposed‚Äîit's always a string.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> flip <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"my-page-flip"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

flip<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>activePage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// &lt;my-page-flip data-active-page="1">&lt;/my-page-flip></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>flip<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>activePage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "1" (string)</span></code></pre></copy-to-clipboard>
<p>This isn't perfect but it works fine for simple scenarios. Let's improve the
solution by defining our own custom attribute and property.</p>
<h3>Custom element attributes and properties</h3>
<p>Rather than use the element <code>dataset</code> we can implement our own attributes and
provide getter and setter functions to expose them as properties. Doing this
provides us with full control over how the data is stored, provides better
encapsulation and more control over how the element will react to changes. To
implement this reactivity pattern we will observe attributes for changes by
listing them in the static <code>observedAttributes</code> property (this could be applied
to <code>data-*</code> attributes too). We then implement the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements#responding_to_attribute_changes"><code>attributeChangedCallback</code></a> method to be notified about
value changes and update the state accordingly.</p>
<p>Here's an example of this in the <code>PageFlip</code> element. We only want to update the
attribute value in the HTML if it is already declared by conditionally calling
<code>setAttribute</code> from the setter function and letting the callback handle updating
the property value.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">PageFlip</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token comment">// Observe changes to active-page attribute</span>
  <span class="token keyword">static</span> observedAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"active-page"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// Initialize the state with a default value</span>
  #activePage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token comment">// Getter for the active page property</span>
  <span class="token keyword">get</span> <span class="token function">activePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#activePage<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Setter for the active page</span>
  <span class="token keyword">set</span> <span class="token function">activePage</span><span class="token punctuation">(</span><span class="token parameter">pageIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If the attribute is set update it and let callback update state</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">"active-page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"active-page"</span><span class="token punctuation">,</span> pageIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// No attribute set so just update state directly</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#setActivePage</span><span class="token punctuation">(</span>pageIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Update the value of the property when the attribute value changes</span>
  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">"active-page"</span> <span class="token operator">&amp;&amp;</span> oldValue <span class="token operator">!==</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#setActivePage</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">#setActivePage</span><span class="token punctuation">(</span><span class="token parameter">pageIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...run animation so show page</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#activePage <span class="token operator">=</span> pageIndex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></copy-to-clipboard>
<h2>Reacting to changes in sub-components</h2>
<p>Custom elements (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components">Web Components</a>, I'll refer to them as
components for the rest of the article) can define <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_templates_and_slots">slots</a>
to inject content into the component tree at specified locations. I won't
include the full implementation of each component here but you can <a href="https://github.com/p-m-p/p-m-p.github.io/tree/main/js/practical-web-component-reactivity-patterns">view the
code</a> for the examples. When the element or elements in the slot
update we may need to react to this change, let's explore some ways to deal with
this reactivity pattern.</p>
<p>We'll implement a pagination component that provides controls for navigating
through a list of pages. It'll need a template that defines the structure of the
component with a default slot (the one that isn't named) to hold the pages,
buttons to navigate to the next and previous page and a status indicator that
displays the active page number alongside the total number of pages.</p>
<copy-to-clipboard><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pagination-tmpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pages<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- default slot --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- Page 1 of n --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>controls<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prev<span class="token punctuation">"</span></span> <span class="token attr-name">aria-controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pages<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Previous<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>next<span class="token punctuation">"</span></span> <span class="token attr-name">aria-controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pages<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Next<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre></copy-to-clipboard>
<p>The component needs to react to changes in the default slot to set the total
number of pages in the status label. It also needs to set and show the active
page when pressing the buttons to navigate.</p>
<h3>Using the slotchange event to react to updates</h3>
<p>Whenever elements are assigned to a slot a <code>slotchange</code> event is dispatched. By
adding an event listener for these we can update the status indicator to show
the total number of pages. This may only happen once when the document is first
loaded or multiple times depending on how the pages are displayed.</p>
<p>Let's start with a basic implementation of the pagination component. We'll add
an event listener for the slot change and display the active page by setting the
CSS display property of the pages.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Pagination</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token comment">// Currently selected page index</span>
  #selectedPageIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// Page selection indicator reference</span>
  #selectionIndicator <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// List of the page elements in the default slot</span>
  #pages <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...attach shadow root, apply the template and add button event listeners</span>

    <span class="token comment">// Store a reference to the selected page indicator</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Listen for slot changes to store reference to the pages elements</span>
    <span class="token comment">// and set the active page</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot
      <span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"slot"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"slotchange"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>#pages <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">assignedElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Start by hiding all pages</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>#pages<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token operator">=></span>
          page<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span> <span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#setSelectedPage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#selectedPageIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">#setSelectedPage</span><span class="token punctuation">(</span><span class="token parameter">pageIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Display only the active page</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#pages<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>#selectedPageIndex<span class="token punctuation">]</span><span class="token operator">?.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span> <span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#pages<span class="token punctuation">[</span>pageIndex<span class="token punctuation">]</span><span class="token operator">?.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span> <span class="token string">"block"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Store the new active page index</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectedPageIndex <span class="token operator">=</span> pageIndex<span class="token punctuation">;</span>

    <span class="token comment">// Update indicator to show selected page</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Page </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>#pages<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></copy-to-clipboard>
<div class="code-demo">
  <my-pagination class="pagination" aria-roledescription="carousel" aria-label="Example pagination container">
    <div class="page" role="group">Page one</div>
    <div class="page" role="group">Page two</div>
    <div class="page" role="group">Page three</div>
  </my-pagination>
</div>
<p>This already works well to update the status indicator and display the active
page. Next we'll add a component that animates the page changes and look at how
we handle inter-component reactivity.</p>
<h3>Using events for web component interactivity</h3>
<p>If we move the responsibility of displaying the active page with an animation to
a new <code>PageFlip</code> component we'll need it to provide a way to notify the
<code>Pagination</code> component of changes to update the status indicator.</p>
<p>The <code>PageFlip</code> component will expose an <code>activePage</code> property (we saw this
earlier) to control the visible page when the navigation buttons are clicked.
For the reactivity pattern we'll use a <a href="https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent">custom event</a> named
<code>pagechange</code> that is dispatched when the active page or total number of pages
changes. The event is set to bubble so we can apply the listener to the slot
element and not to the <code>PageFlip</code> component directly.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PageFlip</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token comment">//... getter, setters and lifecycle methods</span>

  <span class="token function">#setActivePage</span><span class="token punctuation">(</span><span class="token parameter">pageIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...animate page into view</span>

    <span class="token comment">// Store new page index and dispatch event</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#activePage <span class="token operator">=</span> pageIndex<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">"pagechange"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">detail</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">activePage</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>activePage<span class="token punctuation">,</span> <span class="token comment">// the property synced with active-page attribute</span>
          <span class="token literal-property property">totalPages</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token comment">// property that exposes the number of page (children)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></copy-to-clipboard>
<p>Adding the page flip means the default slot now plays host to this component and
the slot change event we used previously will be dispatched only when this
element is assigned.</p>
<copy-to-clipboard><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-pagination</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-page-flip</span> <span class="token attr-name">active-page</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Page one<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Page two<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>Page three<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-page-flip</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-pagination</span><span class="token punctuation">></span></span></code></pre></copy-to-clipboard>
<p>We'll update the <code>Pagination</code> component to remove the page display functionality
and add the <code>pagechange</code> event listener. This component is simpler now and only
responsible for navigating pages and setting the status indicator label.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Pagination</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token comment">// Page selection indicator</span>
  #selectionIndicator <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// Animation container reference</span>
  #animationContainer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...attach shadow root, apply the template and add button event listeners to set activePage</span>

    <span class="token comment">// Store a reference to the selected page indicator</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator <span class="token operator">=</span> shadow<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> slot <span class="token operator">=</span> shadow<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"slot"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Listen for slot changes and store reference to the animation container</span>
    slot<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"slotchange"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>#animationContainer <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">assignedElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Event listener for page change events to update the status indicator</span>
    slot<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pagechange"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> activePage<span class="token punctuation">,</span> totalPages <span class="token punctuation">}</span> <span class="token operator">=</span> ev<span class="token punctuation">.</span>detail<span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Page </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>activePage <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalPages<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></copy-to-clipboard>
<my-pagination-event class="pagination" aria-roledescription="carousel" aria-label="Example pagination container with animation">
  <my-page-flip active-page="0">
    <div class="page" role="group">Page one</div>
    <div class="page" role="group">Page two</div>
    <div class="page" role="group">Page three</div>
  </my-page-flip>
</my-pagination-event>
<p>Events are fundamental to how we build user interfaces on the web with all kinds
of existing events. By applying this pattern to our own components we are able
to split our applications into discrete parts that can be combined together to
create rich user experiences.</p>
<h3>Using a MutationObserver to react to sub component updates</h3>
<p>Sometimes, we might not have an event like <code>pagechange</code> available. Maybe we have
to deal with integrating a new feature into a legacy codebase or use a third
party library we have no control over. In these scenarios we can achieve a
similar result with a <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver"><code>MutationObserver</code></a> to observe changes
to the attributes and children of the element.</p>
<p>This approach here will rely on the <code>active-page</code> attribute correctly reflecting
the <code>activePage</code> property value and some confidence that the list of pages are
the elements direct children (although, we could also apply the observer to the
entire element subtree).</p>
<p>Here's what the <code>Pagination</code> component would look like if we updated it to use a
<code>MutationObserver</code> to control the status indicator instead of the <code>pagechange</code>
event.</p>
<copy-to-clipboard><pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Pagination</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token comment">// Page selection indicator</span>
  #selectionIndicator <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// Animation container reference</span>
  #animationContainer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// Mutation observer reference</span>
  #observer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// On mutations update the selected page status</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#setSelectedPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...attach shadow root, apply the template and add button event listeners to set activePage</span>

    <span class="token comment">// Store a reference to the selected page indicator</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator <span class="token operator">=</span> shadow<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Listen for slot changes to store reference to the page flip component</span>
    <span class="token comment">// and observe for mutations within it</span>
    shadow<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"slot"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"slotchange"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Remove any previous observerations</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>#observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>#animationContainer <span class="token operator">=</span> ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">assignedElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// Add the element to the observer for active-page attribute</span>
      <span class="token comment">// and child list updates</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>#observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#animationContainer<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">attributeFilter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"active-page"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">childList</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#setSelectedPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Update the page status using the page flip component state</span>
  <span class="token function">#setSelectedPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#animationContainer<span class="token punctuation">.</span>activePage <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> totalPages <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#animationContainer<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>#selectionIndicator<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Page </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>totalPages<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></copy-to-clipboard>
<h2>Takeaway</h2>
<p>Custom events are a power tool for implementing components that both work in
isolation and can be combined to create dynamic applications for the web.
Consider also the encapsulation of state through the use of custom property
getters and setters and a pragmatic approach of reflecting this to attribute
values and we have some solid patterns for adding reactivity to our component
development.</p>
<style>
.pagination {
  height: 300px;
  margin: 0 0 1rem;
  &:not(:defined) {
    display: none;
  }
}
.page {
  align-items: center;
  background: white;
  border: solid 2px gray;
  color: black;
  font-weight: bold;
  inset: 0;
  justify-content: center;
  padding: 1rem;
  position: absolute;
  z-index; 1;
  &:nth-child(1) {
    z-index: 2;
  }
}
my-page-flip {
  display: block;
  overflow: hidden;
  position: relative;
  width: 100%;
  height: 100%;
}
</style>
<template id="pagination-tmpl">
  <style>
    :host {
      display: grid;
      grid-template:
        "pages pages" 1fr
        "status controls" auto;
      gap:0.5rem;
    }
    #pages {
      grid-area: pages;
      position: relative;
    }
    #status {
      align-self: center;
      font-size: 0.875rem;
      grid-area: status;
      justify-self: left;
    }
    #controls {
      grid-area: controls;
      justify-self: right;
    }
    button {
      background: light-dark(rgb(255 255 255 / 50%), rgb(255 255 255 / 10%));
      border: solid 1px light-dark(rgb(0 0 0 / 20%), rgb(255 255 255 / 20%));
      border-radius: 0.25rem;
      color: inherit;
      font-size: 0.875rem;
      font-weight: 500;
      margin: 0 0 0 0.5rem;
      padding: 0.5rem 1rem;
    }
  </style>
  <div id="pages">
    <slot></slot>
  </div>
  <div id="status"><!-- Page 1 of n --></div>
  <div id="controls">
    <button id="prev" aria-controls="pages">Previous</button>
    <button id="next" aria-controls="pages">Next</button>
  </div>
</template>

  </main>

</article>

<footer class="site-footer">
  <div class="container">
    <p>&copy; Phil Parsons</p>
    <span aria-hidden="true">&middot;</span>
    <p xmlns:cc="http://creativecommons.org/ns#">Content licensed under <a href="https://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer">CC BY 4.0</a></p>
  </div>
</footer>


<back-to-top data-scroll-behavior="smooth"></back-to-top>


  
    <script src="/js//practical-web-component-reactivity-patterns/index.js" type="module" defer=""></script>
  

<script src="https://cdn.jsdelivr.net/npm/@parsonic/all@1.1.3/min.js" defer=""></script>

</body>

</html>
